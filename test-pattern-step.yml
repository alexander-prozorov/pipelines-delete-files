parameters:
- name: 'pattern'
  type: string
- name: 'files'
  type: string
- name: 'displayName'
  type: string

steps:
- task: CopyFiles@2
  inputs:
    SourceFolder: 'files'
    Contents: '**'
    TargetFolder: 'temp'
- task: DeleteFiles@1
  inputs:
    SourceFolder: $(Build.SourcesDirectory)/temp
    Contents: ${{ parameters.pattern }}
- task: Bash@3
  displayName: ${{ parameters.displayName }}
  inputs:
    targetType: 'inline'
    script: |
      existing=$(find files -type f | xargs)
      echo "Existing fles: $existing, expected: ${{ parameters.files }}"; 
      if [ "$existing" != ${{ parameters.files }} ]; then
        echo "Existing files: $existing, expected: ${{ parameters.files }}"; exit 1;
      fi 
